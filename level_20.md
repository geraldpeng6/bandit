# Bandit Level 19 â†’ Level 20 æ”»ç•¥ ğŸ‘‘

## å…³å¡ç›®æ ‡ ğŸ¯

æœ¬å…³å¡çš„ç›®æ ‡æ˜¯ä½¿ç”¨ä½äºä¸»ç›®å½•ä¸­çš„setuidäºŒè¿›åˆ¶æ–‡ä»¶`bandit20-do`ï¼Œä»¥bandit20ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œä»è€Œè¯»å–`/etc/bandit_pass/bandit20`æ–‡ä»¶è·å–ä¸‹ä¸€å…³çš„å¯†ç ã€‚

## æ‰€éœ€çŸ¥è¯† ğŸ“š

### setuidæƒé™ ğŸ‘‘

setuidï¼ˆSet User IDï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶æƒé™ï¼Œå…è®¸ç”¨æˆ·ä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„èº«ä»½æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å½“ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶è®¾ç½®äº†setuidæƒé™æ—¶ï¼Œå®ƒä¼šä»¥å…¶æ‰€æœ‰è€…çš„æƒé™è¿è¡Œï¼Œè€Œä¸æ˜¯ä»¥æ‰§è¡Œå®ƒçš„ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚

åœ¨æ–‡ä»¶æƒé™ä¸­ï¼Œsetuidæƒé™é€šå¸¸æ˜¾ç¤ºä¸º`s`ï¼Œä½äºæ‰€æœ‰è€…çš„æ‰§è¡Œæƒé™ä½ç½®ï¼Œä¾‹å¦‚ï¼š`-rwsr-xr-x`ã€‚

### æ–‡ä»¶æƒé™æŸ¥çœ‹ ğŸ‘€

å¯ä»¥ä½¿ç”¨`ls -l`å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶çš„è¯¦ç»†æƒé™ä¿¡æ¯ã€‚

### å‘½ä»¤æ‰§è¡Œ ğŸ–¥ï¸

setuidç¨‹åºé€šå¸¸å…è®¸ä»¥ç‰¹å®šçš„æ–¹å¼æ‰§è¡Œå‘½ä»¤ï¼Œä¾‹å¦‚ä»¥å¦ä¸€ä¸ªç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚

## è¯¦ç»†è§£é¢˜æ­¥éª¤ ğŸ“

### 1. ç™»å½•æ¸¸æˆæœåŠ¡å™¨ ğŸ”

ä½¿ç”¨ä¸Šä¸€å…³è·å¾—çš„å¯†ç ç™»å½•æœåŠ¡å™¨ï¼š

```bash
ssh bandit19@bandit.labs.overthewire.org -p 2220
```

å¯†ç ï¼š`IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x`

### 2. æŸ¥çœ‹å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶ ğŸ‘€

ç™»å½•åï¼Œä½¿ç”¨`ls`å‘½ä»¤æŸ¥çœ‹å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š

```bash
ls -la
```

è¾“å‡ºç»“æœåº”è¯¥ç±»ä¼¼äºï¼š

```
total 28
drwxr-xr-x  2 root     root     4096 Oct 16  2018 .
drwxr-xr-x 41 root     root     4096 Oct 16  2018 ..
-rwsr-x---  1 bandit20 bandit19 7296 Oct 16  2018 bandit20-do
-rw-r--r--  1 root     root      220 May 15  2017 .bash_logout
-rw-r--r--  1 root     root     3526 May 15  2017 .bashrc
-rw-r--r--  1 root     root      675 May 15  2017 .profile
```

æ³¨æ„`bandit20-do`æ–‡ä»¶çš„æƒé™ï¼š`-rwsr-x---`ã€‚`s`è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªsetuidç¨‹åºï¼Œå®ƒä¼šä»¥å…¶æ‰€æœ‰è€…ï¼ˆbandit20ï¼‰çš„èº«ä»½è¿è¡Œã€‚

### 3. å°è¯•æ‰§è¡Œsetuidç¨‹åº ğŸ”

æˆ‘ä»¬å¯ä»¥å°è¯•ç›´æ¥æ‰§è¡Œ`bandit20-do`ç¨‹åºï¼Œçœ‹çœ‹å®ƒçš„ç”¨æ³•ï¼š

```bash
./bandit20-do
```

è¾“å‡ºç»“æœå¯èƒ½ç±»ä¼¼äºï¼š

```
Run a command as another user.
  Example: ./bandit20-do id
```

è¿™è¡¨æ˜æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‘½ä»¤ä½œä¸ºå‚æ•°ï¼Œè¯¥å‘½ä»¤å°†ä»¥bandit20ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œã€‚

### 4. ä½¿ç”¨setuidç¨‹åºæŸ¥çœ‹å½“å‰ç”¨æˆ· ğŸ§ª

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`id`å‘½ä»¤éªŒè¯setuidç¨‹åºæ˜¯å¦çœŸçš„ä»¥bandit20ç”¨æˆ·çš„èº«ä»½è¿è¡Œï¼š

```bash
./bandit20-do id
```

è¾“å‡ºç»“æœåº”è¯¥æ˜¾ç¤ºbandit20çš„ç”¨æˆ·IDï¼š

```
uid=11020(bandit20) gid=11019(bandit19) groups=11019(bandit19)
```

è¿™ç¡®è®¤äº†`bandit20-do`ç¨‹åºç¡®å®ä»¥bandit20ç”¨æˆ·çš„èº«ä»½è¿è¡Œã€‚

### 5. ä½¿ç”¨setuidç¨‹åºè¯»å–å¯†ç æ–‡ä»¶ ğŸ”‘

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`bandit20-do`ç¨‹åºä»¥bandit20ç”¨æˆ·çš„èº«ä»½è¯»å–`/etc/bandit_pass/bandit20`æ–‡ä»¶ï¼š

```bash
./bandit20-do cat /etc/bandit_pass/bandit20
```

è¾“å‡ºç»“æœåº”è¯¥æ˜¾ç¤ºbandit20çš„å¯†ç ï¼š

```
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
```

## å‘½ä»¤è§£é‡Š ğŸ”

- `ls -la`ï¼š
  - `ls`ï¼šåˆ—å‡ºç›®å½•å†…å®¹
  - `-l`ï¼šä½¿ç”¨é•¿æ ¼å¼æ˜¾ç¤º
  - `-a`ï¼šæ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶
- `./bandit20-do cat /etc/bandit_pass/bandit20`ï¼š
  - `./bandit20-do`ï¼šæ‰§è¡Œå½“å‰ç›®å½•ä¸­çš„`bandit20-do`ç¨‹åº
  - `cat /etc/bandit_pass/bandit20`ï¼šè¦ä»¥bandit20ç”¨æˆ·èº«ä»½æ‰§è¡Œçš„å‘½ä»¤ï¼Œç”¨äºè¯»å–å¯†ç æ–‡ä»¶

## å­¦ä¹ è¦ç‚¹æ€»ç»“ ğŸ“Œ

1. **setuidæƒé™** - å­¦ä¹ äº†setuidæƒé™çš„æ¦‚å¿µå’Œç”¨é€”
2. **æƒé™è¯†åˆ«** - äº†è§£äº†å¦‚ä½•è¯†åˆ«æ–‡ä»¶çš„setuidæƒé™
3. **ç‰¹æƒå‘½ä»¤æ‰§è¡Œ** - å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨setuidç¨‹åºä»¥å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤
4. **å¯†ç æ–‡ä»¶è®¿é—®** - äº†è§£äº†Linuxç³»ç»Ÿä¸­å¯†ç æ–‡ä»¶çš„å­˜å‚¨ä½ç½®å’Œè®¿é—®æ§åˆ¶

## æç¤º ğŸ’¡

- setuidæ˜¯ä¸€ç§å¼ºå¤§ä½†æ½œåœ¨å±é™©çš„æœºåˆ¶ï¼Œåœ¨å®é™…ç³»ç»Ÿä¸­åº”è°¨æ…ä½¿ç”¨
- åœ¨Linuxç³»ç»Ÿä¸­ï¼Œåªæœ‰rootç”¨æˆ·å¯ä»¥æ›´æ”¹æ–‡ä»¶çš„æ‰€æœ‰è€…
- setuidç¨‹åºé€šå¸¸ç”¨äºå…è®¸æ™®é€šç”¨æˆ·æ‰§è¡Œéœ€è¦ç‰¹æƒçš„ç‰¹å®šä»»åŠ¡
- åœ¨å®‰å…¨ç¯å¢ƒä¸­ï¼Œåº”è¯¥é™åˆ¶setuidç¨‹åºçš„æ•°é‡å’ŒåŠŸèƒ½ï¼Œä»¥å‡å°‘æ½œåœ¨çš„å®‰å…¨é£é™©

## ä¸‹ä¸€æ­¥ â­ï¸

ä½¿ç”¨è·å¾—çš„å¯†ç ç™»å½•åˆ°Level 20ï¼š

```bash
ssh bandit20@bandit.labs.overthewire.org -p 2220
```

å¯†ç ï¼š`GbKksEFF4yrVs6il55v6gwY5aVje5f0j`

## ç›¸å…³èµ„æº ğŸ”—

- [Linuxæ–‡ä»¶æƒé™è¯¦è§£](./resource/level_20/Linuxæ–‡ä»¶æƒé™è¯¦è§£.md)
- [setuidã€setgidå’Œsticky bitè¯¦è§£](./resource/level_20/setuid_setgidå’Œsticky_bitè¯¦è§£.md)
- [Linuxå®‰å…¨æœ€ä½³å®è·µ](./resource/level_20/Linuxå®‰å…¨æœ€ä½³å®è·µ.md)
