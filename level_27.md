# Bandit Level 26 â†’ Level 27 æ”»ç•¥ ğŸ‘‘

## å…³å¡ç›®æ ‡ ğŸ¯

æœ¬å…³å¡çš„ç›®æ ‡æ˜¯ä½¿ç”¨ä½äºä¸»ç›®å½•ä¸­çš„setuidäºŒè¿›åˆ¶æ–‡ä»¶`bandit27-do`ï¼Œä»¥bandit27ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œä»è€Œè¯»å–`/etc/bandit_pass/bandit27`æ–‡ä»¶è·å–ä¸‹ä¸€å…³çš„å¯†ç ã€‚

## æ‰€éœ€çŸ¥è¯† ğŸ“š

### Viç¼–è¾‘å™¨å’ŒShell ğŸ“

ç”±äºæˆ‘ä»¬åœ¨ä¸Šä¸€å…³ä¸­ä½¿ç”¨äº†ç‰¹æ®Šæ–¹æ³•ç™»å½•åˆ°bandit26ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­ä½¿ç”¨Viç¼–è¾‘å™¨æ¥æ‰§è¡Œå‘½ä»¤ã€‚

### setuidæƒé™ ğŸ‘‘

ä¸ä¹‹å‰çš„å…³å¡ç±»ä¼¼ï¼Œsetuidï¼ˆSet User IDï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶æƒé™ï¼Œå…è®¸ç”¨æˆ·ä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„èº«ä»½æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚

### å‘½ä»¤æ‰§è¡Œ ğŸ–¥ï¸

æˆ‘ä»¬éœ€è¦äº†è§£å¦‚ä½•åœ¨å—é™ç¯å¢ƒä¸­æ‰§è¡Œå‘½ä»¤ã€‚

## è¯¦ç»†è§£é¢˜æ­¥éª¤ ğŸ“

### 1. ç™»å½•åˆ°bandit26 ğŸ”

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§ä¸Šä¸€å…³çš„æ–¹æ³•ç™»å½•åˆ°bandit26ã€‚ç¡®ä¿å°†ç»ˆç«¯çª—å£è°ƒæ•´å¾—éå¸¸å°ï¼Œç„¶åä½¿ç”¨SSHå¯†é’¥ç™»å½•ï¼š

```bash
ssh -i bandit26.sshkey bandit26@localhost
```

å½“`more`å‘½ä»¤æš‚åœæ˜¾ç¤º`text.txt`æ–‡ä»¶å†…å®¹æ—¶ï¼ŒæŒ‰`v`é”®è¿›å…¥Viç¼–è¾‘å™¨ã€‚

### 2. åœ¨Viä¸­è·å–Shell ğŸš

åœ¨Viç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®shellå¹¶å¯åŠ¨å®ƒï¼š

```
:set shell=/bin/bash
:shell
```

è¿™ä¼šå¯åŠ¨ä¸€ä¸ªbash shellï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä»¥bandit26ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ã€‚

### 3. æŸ¥çœ‹å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶ ğŸ‘€

ç°åœ¨æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š

```bash
ls -la
```

è¾“å‡ºç»“æœåº”è¯¥ç±»ä¼¼äºï¼š

```
total 36
drwxr-xr-x  3 root     root     4096 Oct 16  2018 .
drwxr-xr-x 41 root     root     4096 Oct 16  2018 ..
-rwsr-x---  1 bandit27 bandit26 7296 Oct 16  2018 bandit27-do
-rw-r--r--  1 root     root      220 May 15  2017 .bash_logout
-rw-r--r--  1 root     root     3526 May 15  2017 .bashrc
-rw-r--r--  1 root     root      675 May 15  2017 .profile
drwxr-xr-x  2 root     root     4096 Oct 16  2018 .ssh
-rw-r-----  1 bandit26 bandit26  258 Oct 16  2018 text.txt
```

æ³¨æ„`bandit27-do`æ–‡ä»¶çš„æƒé™ï¼š`-rwsr-x---`ã€‚`s`è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªsetuidç¨‹åºï¼Œå®ƒä¼šä»¥å…¶æ‰€æœ‰è€…ï¼ˆbandit27ï¼‰çš„èº«ä»½è¿è¡Œã€‚

### 4. å°è¯•æ‰§è¡Œsetuidç¨‹åº ğŸ”

æˆ‘ä»¬å¯ä»¥å°è¯•ç›´æ¥æ‰§è¡Œ`bandit27-do`ç¨‹åºï¼Œçœ‹çœ‹å®ƒçš„ç”¨æ³•ï¼š

```bash
./bandit27-do
```

è¾“å‡ºç»“æœå¯èƒ½ç±»ä¼¼äºï¼š

```
Run a command as another user.
  Example: ./bandit27-do id
```

è¿™è¡¨æ˜æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‘½ä»¤ä½œä¸ºå‚æ•°ï¼Œè¯¥å‘½ä»¤å°†ä»¥bandit27ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œã€‚

### 5. ä½¿ç”¨setuidç¨‹åºæŸ¥çœ‹å½“å‰ç”¨æˆ· ğŸ§ª

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`id`å‘½ä»¤éªŒè¯setuidç¨‹åºæ˜¯å¦çœŸçš„ä»¥bandit27ç”¨æˆ·çš„èº«ä»½è¿è¡Œï¼š

```bash
./bandit27-do id
```

è¾“å‡ºç»“æœåº”è¯¥æ˜¾ç¤ºbandit27çš„ç”¨æˆ·IDï¼š

```
uid=11027(bandit27) gid=11026(bandit26) groups=11026(bandit26)
```

è¿™ç¡®è®¤äº†`bandit27-do`ç¨‹åºç¡®å®ä»¥bandit27ç”¨æˆ·çš„èº«ä»½è¿è¡Œã€‚

### 6. ä½¿ç”¨setuidç¨‹åºè¯»å–å¯†ç æ–‡ä»¶ ğŸ”‘

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`bandit27-do`ç¨‹åºä»¥bandit27ç”¨æˆ·çš„èº«ä»½è¯»å–`/etc/bandit_pass/bandit27`æ–‡ä»¶ï¼š

```bash
./bandit27-do cat /etc/bandit_pass/bandit27
```

è¾“å‡ºç»“æœåº”è¯¥æ˜¾ç¤ºbandit27çš„å¯†ç ï¼š

```
3ba3118a22e93127a4ed485be72ef5ea
```

## å‘½ä»¤è§£é‡Š ğŸ”

- `:set shell=/bin/bash`ï¼š
  - `:`ï¼šåœ¨Viä¸­è¿›å…¥å‘½ä»¤æ¨¡å¼
  - `set shell=/bin/bash`ï¼šè®¾ç½®shellä¸º`/bin/bash`
- `:shell`ï¼š
  - `:`ï¼šåœ¨Viä¸­è¿›å…¥å‘½ä»¤æ¨¡å¼
  - `shell`ï¼šå¯åŠ¨ä¸€ä¸ªshell
- `./bandit27-do cat /etc/bandit_pass/bandit27`ï¼š
  - `./bandit27-do`ï¼šæ‰§è¡Œå½“å‰ç›®å½•ä¸­çš„`bandit27-do`ç¨‹åº
  - `cat /etc/bandit_pass/bandit27`ï¼šè¦ä»¥bandit27ç”¨æˆ·èº«ä»½æ‰§è¡Œçš„å‘½ä»¤ï¼Œç”¨äºè¯»å–å¯†ç æ–‡ä»¶

## å­¦ä¹ è¦ç‚¹æ€»ç»“ ğŸ“Œ

1. **Viç¼–è¾‘å™¨å‘½ä»¤** - å¤ä¹ äº†å¦‚ä½•åœ¨Viç¼–è¾‘å™¨ä¸­æ‰§è¡Œå‘½ä»¤å’Œå¯åŠ¨shell
2. **setuidæƒé™** - å¤ä¹ äº†setuidæƒé™çš„æ¦‚å¿µå’Œç”¨é€”
3. **ç‰¹æƒå‘½ä»¤æ‰§è¡Œ** - å­¦ä¹ äº†å¦‚ä½•åœ¨å—é™ç¯å¢ƒä¸­ä½¿ç”¨setuidç¨‹åºæ‰§è¡Œç‰¹æƒå‘½ä»¤
4. **æ–‡ä»¶æƒé™è¯†åˆ«** - å¤ä¹ äº†å¦‚ä½•è¯†åˆ«æ–‡ä»¶çš„setuidæƒé™

## æç¤º ğŸ’¡

- åœ¨å—é™ç¯å¢ƒä¸­ï¼Œsetuidç¨‹åºæ˜¯è·å–ç‰¹æƒçš„å¸¸ç”¨æ–¹æ³•
- Vi/Vimæ˜¯åŠŸèƒ½å¼ºå¤§çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåœ¨ç³»ç»Ÿç®¡ç†å’Œå®‰å…¨æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨
- åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œåº”è¯¥é™åˆ¶setuidç¨‹åºçš„æ•°é‡å’ŒåŠŸèƒ½ï¼Œä»¥å‡å°‘æ½œåœ¨çš„å®‰å…¨é£é™©
- äº†è§£å¦‚ä½•åœ¨ä¸åŒçš„ç¯å¢ƒå’Œæ¡ä»¶ä¸‹è·å–shellæ˜¯ä¸€é¡¹é‡è¦çš„æŠ€èƒ½

## ä¸‹ä¸€æ­¥ â­ï¸

ä½¿ç”¨è·å¾—çš„å¯†ç ç™»å½•åˆ°Level 27ï¼š

```bash
ssh bandit27@bandit.labs.overthewire.org -p 2220
```

å¯†ç ï¼š`3ba3118a22e93127a4ed485be72ef5ea`

## ç›¸å…³èµ„æº ğŸ”—

- [Vi/Vimç¼–è¾‘å™¨å‘½ä»¤è¯¦è§£](https://www.tutorialspoint.com/vim/vim_commands.htm)
- [Linuxæ–‡ä»¶æƒé™è¯¦è§£](https://www.linux.com/training-tutorials/understanding-linux-file-permissions/)
- [setuidã€setgidå’Œsticky bitè¯¦è§£](https://www.geeksforgeeks.org/setuid-setgid-and-sticky-bits-in-linux-file-permissions/)
