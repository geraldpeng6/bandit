# Linux文件系统层次结构标准详解 📂

## 什么是文件系统层次结构标准？ 🤔

**文件系统层次结构标准**（Filesystem Hierarchy Standard，简称**FHS**）是一个参考标准，描述了类Unix系统中文件和目录的组织约定。虽然它因在Linux发行版中的广泛应用而流行，但其他类Unix系统也使用这一标准。FHS由Linux基金会维护，最新版本是2015年6月3日发布的3.0版。

## 为什么需要FHS？ 🎯

在Linux系统中，所有文件和目录都出现在根目录（`/`）下，即使它们实际上存储在不同的物理或虚拟设备上。FHS的目的是：

- 确保用户能够找到安装在系统中的程序和文件
- 确保系统管理员能够预测程序和文件的位置
- 提供一个统一的标准，使软件开发者能够预测系统的基本布局
- 减少不同Linux发行版之间的差异，提高兼容性

## 目录结构详解 📚

### 根目录（/）下的主要目录

| 目录 | 描述 |
|------|------|
| `/` | **主层次结构的根**，整个文件系统层次结构的根目录 |
| `/bin` | **基本命令二进制文件**，系统启动或修复时需要的基本命令，对所有用户可用（如cat、ls、cp等） |
| `/boot` | **引导加载程序文件**，包括内核、initrd等启动系统所需的文件 |
| `/dev` | **设备文件**，包含设备节点，如/dev/null、/dev/sda1、/dev/tty等 |
| `/etc` | **主机特定的系统配置文件**，包含系统范围内的配置文件 |
| `/home` | **用户主目录**，包含用户的个人文件、设置等 |
| `/lib` | **基本共享库**，/bin和/sbin中二进制文件所需的库文件 |
| `/media` | **可移动媒体的挂载点**，如CD-ROM、USB驱动器等 |
| `/mnt` | **临时挂载的文件系统**，用于临时挂载其他文件系统 |
| `/opt` | **附加应用软件包**，用于安装第三方软件 |
| `/proc` | **进程信息虚拟文件系统**，提供关于进程和内核的信息 |
| `/root` | **root用户的主目录**，超级用户的个人文件 |
| `/run` | **运行时变量数据**，包含自上次启动以来的系统信息 |
| `/sbin` | **系统二进制文件**，系统管理命令（如fsck、init、route） |
| `/srv` | **服务数据**，系统提供的服务数据，如web服务器、FTP服务器的数据 |
| `/sys` | **系统虚拟文件系统**，包含关于设备、驱动程序和内核功能的信息 |
| `/tmp` | **临时文件目录**，系统重启后通常不会保留 |
| `/usr` | **用户二进制文件和只读数据**，包含大多数用户和应用程序使用的文件 |
| `/var` | **可变文件**，内容在系统正常操作期间预期会变化的文件，如日志、邮件等 |

### /etc 目录 - 系统配置文件 ⚙️

`/etc`目录包含主机特定的系统配置文件。这个名称的由来有些争议：

- 在早期Unix文档中，它被称为"etcetera目录"（等等目录），因为历史上它存放了不属于其他地方的所有内容
- 现代解释包括"可编辑文本配置"(Editable Text Configuration)或"扩展工具箱"(Extended Tool Chest)等反向缩略词

重要的子目录包括：

- `/etc/opt`：/opt中附加包的配置文件
- `/etc/X11`：X Window系统（版本11）的配置文件
- `/etc/sgml`和`/etc/xml`：处理SGML和XML的软件的配置文件

### /usr 目录 - 用户程序和数据 👥

`/usr`目录是**次级层次结构**，包含只读的用户数据和多用户实用程序。这个目录应该是可共享和只读的。主要子目录包括：

- `/usr/bin`：非必要命令二进制文件（单用户模式下不需要的）
- `/usr/include`：标准包含文件（头文件）
- `/usr/lib`：/usr/bin和/usr/sbin中二进制文件的库
- `/usr/local`：**第三级层次结构**，用于本地数据，特定于此主机
- `/usr/sbin`：非必要系统二进制文件（如网络服务的守护进程）
- `/usr/share`：架构无关（共享）数据
- `/usr/src`：源代码（如内核源代码及其头文件）

> 🔍 **历史趣闻**：`/usr`最初代表"user"（用户）。当Ken Thompson和Dennis Ritchie将Unix迁移到PDP-11时，/bin和/lib目录的内容太大，无法放在一个RK05磁盘驱动器上。所以他们将一些文件放在第二个RK05上，确保第一个驱动器包含加载第二个所需的所有内容。其余文件被放入`/usr`目录。当他们获得第三个驱动器时，用户文件被移到了一个名为`/home`的新目录。

### /var 目录 - 可变数据 📊

`/var`目录包含在系统正常操作期间预期会变化的文件，如日志、邮件等。主要子目录包括：

- `/var/cache`：应用程序缓存数据
- `/var/lib`：状态信息，程序运行时修改的持久数据
- `/var/log`：各种日志文件
- `/var/mail`：邮箱文件
- `/var/run`：运行时变量数据（在FHS 3.0中，被`/run`替代）
- `/var/spool`：等待处理的任务的队列（如打印队列）
- `/var/tmp`：在重启之间保留的临时文件

## FHS的遵循情况 🔄

大多数Linux发行版遵循文件系统层次结构标准，并将其声明为自己的政策以保持FHS兼容性。但也有一些发行版有意不遵循这一标准，如GoboLinux和NixOS。

一些常见的偏离包括：

- 现代Linux发行版包含一个`/sys`目录作为虚拟文件系统（sysfs）
- 一些Linux发行版不再区分`/lib`和`/usr/lib`，将`/lib`符号链接到`/usr/lib`
- 一些发行版不再区分`/bin`和`/usr/bin`以及`/sbin`和`/usr/sbin`

## FHS的历史 📜

FHS最初是作为FSSTND（文件系统标准）创建的，主要基于其他类Unix操作系统的类似标准。值得注意的例子包括：

- 自1979年Version 7 Unix发布以来就存在的文件系统布局的hier(7)描述
- SunOS filesystem(7)及其后继者Solaris filesystem(7)

### 发布历史

| 版本 | 发布日期 | 备注 |
|------|----------|------|
| 1.0 | 1994-02-14 | FSSTND |
| 1.1 | 1994-10-09 | FSSTND |
| 1.2 | 1995-03-28 | FSSTND |
| 2.0 | 1997-10-26 | 标准名称改为FHS |
| 2.1 | 2000-04-12 | FHS |
| 2.2 | 2001-05-23 | FHS |
| 2.3 | 2004-01-29 | FHS |
| 3.0 | 2015-05-18 | FHS（最新版本） |

## 实际应用 🛠️

了解FHS对于Linux用户和系统管理员非常重要，因为它帮助你：

1. **快速找到文件**：知道系统中各种文件的标准位置
2. **理解系统结构**：更好地理解Linux系统的组织方式
3. **排除故障**：当系统出现问题时，知道在哪里查找配置文件和日志
4. **编写脚本**：编写能在不同Linux发行版上工作的脚本

## 小贴士 💡

- 使用`ls -la /`命令可以查看根目录下的所有目录
- 使用`man hier`命令可以查看系统的文件系统层次结构手册
- 大多数Linux发行版的文件系统结构都遵循FHS，但可能有细微差别
- 了解FHS可以帮助你在不同的Linux发行版之间更轻松地切换

## 练习题 🧩

1. `/etc`目录主要用于存储什么类型的文件？
2. 系统启动所需的文件通常存储在哪个目录？
3. 用户的个人文件通常存储在哪个目录？
4. 临时文件应该存储在哪个目录？
5. `/usr/local`目录的主要用途是什么？

---

通过理解Linux文件系统层次结构标准，你将能够更有效地导航和管理Linux系统，无论你使用的是哪个发行版。这种标准化的结构是Linux系统强大而灵活的基础之一！
